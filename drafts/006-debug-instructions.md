# Debug instructions - DRAFT

*feel free to provide examples if you think something can be unclear*

## Definitions

_debug_: to search for and eliminate malfunctioning elements or errors

_instruction_: a byte code, read by the virtual machine, starting a specific action

_breakpoint_: a point in a program at which operation may be interrupted for debugging purposes or manual intervention, and then resumed

## Precisions

*remove if empty, not necessary in the draft*

When programming in (nearly) any language, we will encounter bugs, and the best tool to help us solve it is a debugger. As of writing, ArkScript doesn't have any way to debug a program, other than randomly putting `(print "in here")` here and there, nor breakpoints. The goal of this RFC is to suggest a way of adding those functionalities to the virtual machine without impacting performances.

## Debug instructions

We will need specific instructions which the virtual machine will eventually read (if present in the bytecode).

### DEBUG_LINE

Indicates the current line of code in the original source file.

### DEBUG_SUBPROBLEM

Indicates the current subproblem of code at runtime.

### DEBUG_REDUCTION

Indicates the current reduction of code at runtime.

### DEBUG_FILE

Indicates the name of the original file.

### BREAKPOINT

Stops the execution of the program and bring up a simple REPL to show current variables, get scopes count and other pieces of information on the scopes, the current file and line. Execution of the program can be resumed.

*Nota bene*: this instruction should do its best not to alter in any way the values in the program

## A specific flag at compile time

To introduce those specific debug instructions only when needed (e.g. when integrating ArkScript with VSCode debugger), we will want to add a specific flag like `-g` (inspired by `-g` option for gcc and g++, the name is subject to change), which will tell the compiler to generate those instructions.

The default behaviour (no debug flag) is to not add any debug instructions in the generated bytecode.

# Authors

(add your name here)

* [Alexandre Plateau](https://github.com/SuperFola)